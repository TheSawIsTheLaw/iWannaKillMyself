\section{Исследовательский раздел}
\subsection{Условия исследований}
Исследование проводилось на персональном компьютере со следующими характеристиками:

\begin{itemize}
\item процессор Apple M1 Pro,
\item операционная система macOS Ventura 13.5.2 (22G91),
\item 32 Гб оперативной памяти.
\end{itemize}

Для определения гиперпараметров каждой модели применялся метод поиска по сетке с опорой на значение F1-меры. Разбиение данных на выборки производилось на 4 части, 1 из которых используется в качестве тестовой, результаты приводятся для каждого разбиения.

\subsection{ Градиентный бустинг }

Параметры модели при применении метода векторизации ``мешок слов'':
\begin{itemize}
	\item коэффициент обучения -- влияет на скорость обучения -- 0.5;
	\item количество классификаторов в ансамбле -- определяет количество деревьев, используемых в алгоритме -- 215;
	\item минимальное количество образцов для разбиения узла дерева решений -- 5.
\end{itemize}

На рисунке \ref{img:gradientMatrBag} представлены матрицы ошибок, полученные с использованием градиентного бустинга, метод векторизации -- ``мешок слов''.
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{inc/plots/gradientMatrBag.pdf}
	\caption{ Матрицы ошибок в зависимости от номера разбиения, полученные с использованием градиентного бустинга (метод векторизации -- ``мешок слов''). }
	\label{img:gradientMatrBag}
\end{figure}

На рисунке \ref{img:gradientMetricsBag} представлены оценки классификатора, полученные с использованием градиентного бустинга, метод векторизации -- ``мешок слов''.
\begin{figure}[H]
	\centering
	\includegraphics[height=23cm]{inc/plots/gradientMetricsBag.pdf}
	\caption{ Оценки классификатора в зависимости от номера разбиения, полученные с использованием градиентного бустинга (метод векторизации --  ``мешок слов''). }
	\label{img:gradientMetricsBag}
\end{figure}

Параметры модели при применении векторизации BERT:
\begin{itemize}
	\item коэффициент обучения -- 0.3;
	\item количество классификаторов в ансамбле -- 245;
	\item минимальное количество образцов для разбиения узла дерева решений -- 16.
\end{itemize}

На рисунке \ref{img:gradientMatrBert} представлены матрицы ошибок, полученные с использованием градиентного бустинга, метод векторизации -- BERT.
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{inc/plots/gradientMatrBert.pdf}
	\caption{ Матрицы ошибок в зависимости от номера разбиения, полученные с использованием градиентного бустинга (метод векторизации -- BERT). }
	\label{img:gradientMatrBert}
\end{figure}

На рисунке \ref{img:gradientMetricsBert} представлены оценки классификатора, полученные с использованием градиентного бустинга, метод векторизации -- BERT.
\begin{figure}[H]
	\centering
	\includegraphics[height=23cm]{inc/plots/gradientMetricsBert.pdf}
	\caption{ Оценки классификатора в зависимости от номера разбиения, полученные с использованием градиентного бустинга (метод векторизации -- BERT). }
	\label{img:gradientMetricsBert}
\end{figure}



\subsection{ Метод случайного леса }

Параметры модели при применении метода векторизации ``мешок слов'':
\begin{itemize}
	\item максимальная глубина -- определяет максимальную глубину дерева решений -- 300;
	\item максимальное количество признаков -- определяет максимальное количество признаков, используемых для разбиения узла дерева решений, может принимать значение функции -- \textit{log2};
	\item количество классификаторов в ансамбле -- определяет количество деревьев, используемых в алгоритме, -- 850.
\end{itemize}

На рисунке \ref{img:randomMatrBag} представлены матрицы ошибок, полученные с использованием метода случайного леса, метод векторизации -- ``мешок слов''.
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{inc/plots/randomMatrBag.pdf}
	\caption{ Матрицы ошибок в зависимости от номера разбиения, полученные с использованием метода случайного леса (метод векторизации -- ``мешок слов''). }
	\label{img:randomMatrBag}
\end{figure}

На рисунке \ref{img:randomMetricsBag} представлены оценки классификатора, полученные с использованием метода случайного леса, метод векторизации -- ``мешок слов''.
\begin{figure}[H]
	\centering
	\includegraphics[height=23cm]{inc/plots/randomMetricsBag.pdf}
	\caption{ Оценки классификатора в зависимости от номера разбиения, полученные с использованием метода случайного леса (метод векторизации --  ``мешок слов''). }
	\label{img:randomMetricsBag}
\end{figure}


Параметры модели при применении векторизации BERT:
\begin{itemize}
	\item максимальная глубина -- 500;
	\item максимальное количество признаков -- \textit{log_2};
	\item количество классификаторов в ансамбле -- 2500.
\end{itemize}

На рисунке \ref{img:randomMatrBert} представлены матрицы ошибок, полученные с использованием метода случайного леса, метод векторизации -- BERT.
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{inc/plots/randomMatrBert.pdf}
	\caption{ Матрицы ошибок в зависимости от номера разбиения, полученные с использованием метода случайного леса (метод векторизации -- BERT). }
	\label{img:randomMatrBert}
\end{figure}

На рисунке \ref{img:randomMetricsBert} представлены оценки классификатора, полученные с использованием метода случайного леса, метод векторизации -- BERT.
\begin{figure}[H]
	\centering
	\includegraphics[height=23cm]{inc/plots/randomMetricsBert.pdf}
	\caption{ Оценки классификатора в зависимости от номера разбиения, полученные с использованием метода случайного леса (метод векторизации -- BERT). }
	\label{img:randomMetricsBert}
\end{figure}



\subsection{ Метод опорных векторов }

Параметры модели при применении метода векторизации ``мешок слов'':
\begin{itemize}
	\item регуляризационный параметр -- определяет степень регуляризации модели -- 7.0;
	\item ядро -- определяет тип ядра, используемого в модели -- RBF (радиальное базисной функции);
	\item коэффициент ядра -- определяет ``ширину'' ядра -- значение вычисляется как обратная величина произведения количества признаков на дисперсию признаков.
\end{itemize}

На рисунке \ref{img:svcMatrBag} представлены матрицы ошибок, полученные с использованием метода опорных векторов, метод векторизации -- ``мешок слов''.
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{inc/plots/svcMatrBag.pdf}
	\caption{ Матрицы ошибок в зависимости от номера разбиения, полученные с использованием метода опорных векторов (метод векторизации -- ``мешок слов''). }
	\label{img:svcMatrBag}
\end{figure}

На рисунке \ref{img:svcMetricsBag} представлены оценки классификатора, полученные с использованием метода опорных векторов, метод векторизации -- ``мешок слов''.
\begin{figure}[H]
	\centering
	\includegraphics[height=23cm]{inc/plots/svcMetricsBag.pdf}
	\caption{ Оценки классификатора в зависимости от номера разбиения, полученные с использованием метода опорных векторов (метод векторизации --  ``мешок слов''). }
	\label{img:svcMetricsBag}
\end{figure}


Параметры модели при применении векторизации BERT:
\begin{itemize}
	\item регуляризационный параметр -- 1.5;
	\item ядро -- линейное;
	\item коэффициент ядра -- значение вычисляется как обратная величина произведения количества признаков на дисперсию признаков.
\end{itemize}

На рисунке \ref{img:svcMatrBert} представлены матрицы ошибок, полученные с использованием метода опорных векторов, метод векторизации -- BERT.
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{inc/plots/svcMatrBert.pdf}
	\caption{ Матрицы ошибок в зависимости от номера разбиения, полученные с использованием метода опорных векторов (метод векторизации -- BERT). }
	\label{img:svcMatrBert}
\end{figure}

На рисунке \ref{img:svcMetricsBert} представлены оценки классификатора, полученные с использованием метода опорных векторов, метод векторизации -- BERT.
\begin{figure}[H]
	\centering
	\includegraphics[height=23cm]{inc/plots/svcMetricsBert.pdf}
	\caption{ Оценки классификатора в зависимости от номера разбиения, полученные с использованием метода опорных векторов (метод векторизации -- BERT). }
	\label{img:svcMetricsBert}
\end{figure}



\subsection{ Метод K-ближайших соседей }

Параметры модели при применении метода векторизации ``мешок слов'':
\begin{itemize}
	\item количество образцов в листе дерева -- 4;
	\item метрика расстояния -- евклидово расстояние;
	\item количество ближайших соседей -- 5;
	\item метод вычисления весов ближайших соседей -- веса, обратно пропорциональные расстоянию до соседа.
\end{itemize}

На рисунке \ref{img:knnMatrBag} представлены матрицы ошибок, полученные с использованием метода K-ближайших соседей, метод векторизации -- ``мешок слов''.
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{inc/plots/knnMatrBag.pdf}
	\caption{ Матрицы ошибок в зависимости от номера разбиения, полученные с использованием метода K-ближайших соседей (метод векторизации -- ``мешок слов''). }
	\label{img:knnMatrBag}
\end{figure}

На рисунке \ref{img:knnMetricsBag} представлены оценки классификатора, полученные с использованием метода K-ближайших соседей, метод векторизации -- ``мешок слов''.
\begin{figure}[H]
	\centering
	\includegraphics[height=23cm]{inc/plots/knnMetricsBag.pdf}
	\caption{ Оценки классификатора в зависимости от номера разбиения, полученные с использованием метода K-ближайших соседей (метод векторизации --  ``мешок слов''). }
	\label{img:knnMetricsBag}
\end{figure}


Параметры модели при применении векторизации BERT:
\begin{itemize}
	\item количество образцов в листе дерева -- 1;
	\item метрика расстояния -- евклидово расстояние;
	\item количество ближайших соседей -- 6;
	\item метод вычисления весов ближайших соседей -- веса, обратно пропорциональные расстоянию до соседа.
\end{itemize}

На рисунке \ref{img:knnMatrBert} представлены матрицы ошибок, полученные с использованием метода K-ближайших соседей, метод векторизации -- BERT.
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{inc/plots/knnMatrBert.pdf}
	\caption{ Матрицы ошибок в зависимости от номера разбиения, полученные с использованием метода K-ближайших соседей (метод векторизации -- BERT). }
	\label{img:knnMatrBert}
\end{figure}

На рисунке \ref{img:knnMetricsBert} представлены оценки классификатора, полученные с использованием метода K-ближайших соседей, метод векторизации -- BERT.
\begin{figure}[H]
	\centering
	\includegraphics[height=23cm]{inc/plots/knnMetricsBert.pdf}
	\caption{ Оценки классификатора в зависимости от номера разбиения, полученные с использованием метода K-ближайших соседей (метод векторизации -- BERT). }
	\label{img:knnMetricsBert}
\end{figure}



\subsection{ Логистическая регрессия }

Параметры модели при применении метода векторизации ``мешок слов'':
\begin{itemize}
	\item регуляризационный параметр -- 2.2;
	\item веса классов -- сбалансированно;
	\item штраф -- определяет тип штрафа, используемого для регуляризации -- сумма квадратов весов модели, умноженных на гиперпараметр регуляризации;
	\item алгоритм оптимизации -- liblinear.
\end{itemize}

На рисунке \ref{img:logicMatrBag} представлены матрицы ошибок, полученные с использованием логистической регрессии, метод векторизации -- ``мешок слов''.
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{inc/plots/logicMatrBag.pdf}
	\caption{ Матрицы ошибок в зависимости от номера разбиения, полученные с использованием логистической регрессии (метод векторизации -- ``мешок слов''). }
	\label{img:logicMatrBag}
\end{figure}

На рисунке \ref{img:logicMetricsBag} представлены оценки классификатора, полученные с использованием логистической регрессии, метод векторизации -- ``мешок слов''.
\begin{figure}[H]
	\centering
	\includegraphics[height=23cm]{inc/plots/logicMetricsBag.pdf}
	\caption{ Оценки классификатора в зависимости от номера разбиения, полученные с использованием логистической регрессии (метод векторизации --  ``мешок слов''). }
	\label{img:logicMetricsBag}
\end{figure}


Параметры модели при применении векторизации BERT:
\begin{itemize}
	\item регуляризационный параметр -- 2.1;
	\item веса классов -- сбалансированно;
	\item штраф -- сумма квадратов весов модели, умноженных на гиперпараметр регуляризации;
	\item алгоритм оптимизации -- liblinear.
\end{itemize}
На рисунке \ref{img:logicMatrBert} представлены матрицы ошибок, полученные с использованием логистической регрессии, метод векторизации -- BERT.

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{inc/plots/logicMatrBert.pdf}
	\caption{ Матрицы ошибок в зависимости от номера разбиения, полученные с использованием логистической регрессии (метод векторизации -- BERT). }
	\label{img:logicMatrBert}
\end{figure}

На рисунке \ref{img:logicMetricsBert} представлены оценки классификатора, полученные с использованием логистической регрессии, метод векторизации -- BERT.
\begin{figure}[H]
	\centering
	\includegraphics[height=23cm]{inc/plots/logicMetricsBert.pdf}
	\caption{ Оценки классификатора в зависимости от номера разбиения, полученные с использованием логистической регрессии (метод векторизации -- BERT). }
	\label{img:logicMetricsBert}
\end{figure}



\subsection{ Перцептрон }

Параметры модели при применении метода векторизации ``мешок слов'':
\begin{itemize}
	\item скорость обучения -- 0.0001;
	\item максимальное количество итераций при обучении -- 30;
	\item штраф -- сумма квадратов весов модели, умноженных на гиперпараметр регуляризации.
\end{itemize}

На рисунке \ref{img:perceptronMatrBag} представлены матрицы ошибок, полученные с использованием перцептрона, метод векторизации -- ``мешок слов''.
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{inc/plots/perceptronMatrBag.pdf}
	\caption{ Матрицы ошибок в зависимости от номера разбиения, полученные с использованием перцептрона (метод векторизации -- ``мешок слов''). }
	\label{img:perceptronMatrBag}
\end{figure}

На рисунке \ref{img:perceptronMetricsBag} представлены оценки классификатора, полученные с использованием перцептрона, метод векторизации -- ``мешок слов''.
\begin{figure}[H]
	\centering
	\includegraphics[height=23cm]{inc/plots/perceptronMetricsBag.pdf}
	\caption{ Оценки классификатора в зависимости от номера разбиения, полученные с использованием перцептрона (метод векторизации --  ``мешок слов''). }
	\label{img:perceptronMetricsBag}
\end{figure}


Параметры модели при применении векторизации BERT:
\begin{itemize}
	\item скорость обучения -- 0.0001;
	\item максимальное количество итераций при обучении -- 30;
	\item штраф -- абсолютное значение коэффициентов модели.
\end{itemize}

На рисунке \ref{img:perceptronMatrBert} представлены матрицы ошибок, полученные с использованием перцептрона, метод векторизации -- BERT.
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{inc/plots/perceptronMatrBert.pdf}
	\caption{ Матрицы ошибок в зависимости от номера разбиения, полученные с использованием перцептрона (метод векторизации -- BERT). }
	\label{img:perceptronMatrBert}
\end{figure}

На рисунке \ref{img:perceptronMetricsBert} представлены оценки классификатора, полученные с использованием перцептрона, метод векторизации -- BERT.
\begin{figure}[H]
	\centering
	\includegraphics[height=23cm]{inc/plots/perceptronMetricsBert.pdf}
	\caption{ Оценки классификатора в зависимости от номера разбиения, полученные с использованием перцептрона (метод векторизации -- BERT). }
	\label{img:perceptronMetricsBert}
\end{figure}

\subsection{ Результат }

\begin{table}[H]
	\begin{center}
		\caption{\label{table:result} Результаты исследования}
		\begin{tabular}{|p{4cm}|p{4cm}|p{2cm}|p{2cm}|p{2cm}|}
				\hline
			Алгоритм & Векторизация & Точность & F1-мера & ROC-AUC \\
				\hline\hline
			
			\multirow{8}{*}{\shortstack[l]{Градиентный \\ бустинг}} 
			& ``Мешок слов'' & 0.854 & 0.852 & 0.928 \\
				\cline{3-5} & & 0.840 & 0.830 & 0.910 \\
				\cline{3-5} & & 0.860 & 0.835 & 0.910 \\
				\cline{3-5} & & 0.858 & 0.853 & 0.927 \\
			\cline{2-5}
			& BERT & 0.852 & 0.848 & 0.936 \\
				\cline{3-5} & & 0.848 & 0.831 & 0.916 \\
				\cline{3-5} & & 0.856 & 0.849 & 0.926 \\
				\cline{3-5} & & 0.890 & 0.878 & 0.939 \\
			\hline\hline
			
			\multirow{8}{*}{\shortstack[l]{Случайный \\ лес}} 
			& ``Мешок слов'' & 0.876 & 0.875 & 0.952 \\
				\cline{3-5} & & 0.862 & 0.868 & 0.940 \\
				\cline{3-5} & & 0.890 & 0.879 & 0.938 \\
				\cline{3-5} & & 0.882 & 0.879 & 0.957 \\
			\cline{2-5}
			& BERT & 0.882 & 0.888 & 0.953 \\
				\cline{3-5} & & 0.886 & 0.879 & 0.945 \\
				\cline{3-5} & & 0.880 & 0.866 & 0.936 \\
				\cline{3-5} & & 0.896 & 0.899 & 0.960 \\
			\hline\hline
			
			\multirow{8}{*}{\shortstack[l]{Градиентный \\ бустинг}} 
			& ``Мешок слов'' & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
			\cline{2-5}
			& BERT & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
			\hline\hline
			
			\multirow{8}{*}{\shortstack[l]{Градиентный \\ бустинг}} 
			& ``Мешок слов'' & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
			\cline{2-5}
			& BERT & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
			\hline\hline
			
			\multirow{8}{*}{\shortstack[l]{Градиентный \\ бустинг}} 
			& ``Мешок слов'' & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
			\cline{2-5}
			& BERT & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
			\hline\hline
			
			\multirow{8}{*}{\shortstack[l]{Градиентный \\ бустинг}} 
			& ``Мешок слов'' & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
			\cline{2-5}
			& BERT & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
				\cline{3-5} & & ac & f1 & roc \\
					
			\hline
		\end{tabular}
	\end{center}
\end{table}
